<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Danh sách Blog</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-4">
  <h2 class="text-center mb-4">Danh sách Blog</h2>

  <div class="d-flex justify-content-between align-items-center mb-3">
    <div class="d-flex align-items-center">
      <label class="me-2 fw-bold">Lọc theo danh mục:</label>
      <select class="form-select" style="width: 250px"
              onchange="location.href='/blogs/category/' + this.value">
        <option value="">-- Tất cả danh mục --</option>
        <option th:each="cat : ${categories}"
                th:value="${cat.id}"
                th:text="${cat.name}"
                th:selected="${selectedCategory != null and cat.id == selectedCategory.id}">
        </option>
      </select>
    </div>

    <div>
      <a href="/blogs/create" class="btn btn-primary me-2">+ Viết Blog</a>
      <a href="/categories/create" class="btn btn-outline-success">+ Thêm Category</a>
    </div>
  </div>

  <table class="table table-bordered table-striped">
    <thead>
    <tr>
      <th>Tiêu đề</th>
      <th>Tác giả</th>
      <th>Danh mục</th>
      <th>Ngày tạo</th>
      <th>Hành động</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="blog : ${blogs.content}">
      <td th:text="${blog.title}"></td>
      <td th:text="${blog.author != null ? blog.author : 'Không rõ'}"></td>
      <td th:text="${blog.category != null ? blog.category.name : 'Chưa có'}"></td>
      <td th:text="${#temporals.format(blog.createdAt, 'dd/MM/yyyy HH:mm')}"></td>
      <td>
        <a th:href="@{/blogs/{id}(id=${blog.id})}" class="btn btn-sm btn-info text-white">Xem</a>
        <a th:href="@{/blogs/edit/{id}(id=${blog.id})}" class="btn btn-sm btn-warning">Sửa</a>
        <a th:href="@{/blogs/delete/{id}(id=${blog.id})}" class="btn btn-sm btn-danger"
           onclick="return confirm('Bạn có chắc muốn xóa blog này?')">Xóa</a>
      </td>
    </tr>
    </tbody>
  </table>
  <div class="d-flex justify-content-center mt-3">
    <nav>
      <ul class="pagination">
        <li th:classappend="${!blogs.hasPrevious()} ? 'disabled'">
          <a th:href="@{/blogs(page=${blogs.number - 1})}" class="page-link">Trang trước</a>
        </li>

        <li th:each="i : ${#numbers.sequence(0, blogs.totalPages - 1)}"
            th:classappend="${i == blogs.number} ? 'active'">
          <a th:href="@{/blogs(page=${i})}" class="page-link" th:text="${i + 1}"></a>
        </li>

        <li th:classappend="${!blogs.hasNext()} ? 'disabled'">
          <a th:href="@{/blogs(page=${blogs.number + 1})}" class="page-link">Trang sau</a>
        </li>
      </ul>
    </nav>
  </div>

</div>
</body>
</html>
